<!-- w2019d-bga - CLEARANCE & LXR - JuanMa - 06.18.19 -->

<style>

.jm-bga-14-bga_1_w19-19-b img{
  width: 36%;
}

.jm-bga-14-bga_1_w19-19-b .jm-bga-header{
  color: white;
  font-size: 1.5em;
}
.jm-bga-14-gbga_1_w20-19-d .jm-bga-header{
  color: white;
  font-size: 2.4em;
  line-height: 1;
}

.jm-bga-14-bga_1_w19-19-b .jm-bga-header span{
  font-size: 3.8em;
  letter-spacing: -5px;
  position: relative;
  line-height: 1;
}

.jm-bga-14-bga_1_w19-19-b .jm-bga-header span sup{
  font-size: 0.2em;
  position: absolute;
  top: 29%;
  right: -2%;
}
.jm-bga-14-gbga_1_w20-19-d .jm-bga-header > span{
  display: block;
  text-align: center;
}
.jm-bga-14-gbga_1_w20-19-d .jm-bga-line1{
  color: #cc283e;
}
.jm-bga-wrap .jm-col{
    display: inline-block;
    vertical-align: middle;
    line-height: 1;
    font-size: 0.8em;
}
.jm-bga-wrap .jm-75{
  font-size: 3.5em;
}
.jm-bga-wrap .jm-percentage{
  font-size: 2.6em;
}


@media screen and (max-width: 500px){
.plp-wrapper .jm-bga-type-1{
  display: none;
  width: 100%;
  padding-top: 60%;
}
.jm-bga-14-bga_1_w19-19-b{
  background: #31514c;  
}
.jm-bga-14-bga_1_w19-19-b .jm-bga-header{
  margin: 0;
}
.jm-bga-14-bga_1_w19-19-b img{
  filter: invert(100%);  
}
.jm-bga-14-bga_1_w19-19-b{
  font-size: 3vw;
}


}

</style>

<script>

//BGAs DATA

// GBGA_1 CLEARANCE 6/23 - continuous
gbga_1_position = "15";
gbga_1_type = "1";
gbga_1_key = "gbga_1_w20-19-d";
gbga_1_line_1 = "<p class='jm-bga-line1'>ONLINE & IN-STORE</p>";
gbga_1_h2 = "SEMI-ANNUAL <br/>CLEARANCE<br/>EVENT<span> <span class='jm-col'>UP<br/>TO</span><span class='jm-col jm-75'>75</span><span class='jm-col'><span class='jm-percentage'>%</span><br/>OFF</span></span>";
gbga_1_aligment = "center";
gbga_1_url = "/clearance?imc=bga_p1&imccat=w2019d-clearance";
gbga_1_cta = "SHOP NOW";
gbga_1_cta_type = "light";
gbga_1_text_top_cta = "";
gbga_1_img = "refresh/refresh-2019/W1919/zBGA/01_06Week2BGA_Clearance_PHASE1.jpg?$staticlink$";
gbga_1_cat1 = "women,men,shoes,kids,handbags&accessories,beauty,home&tech";
gbga_1_cat3_exceptions = "handbags&accessories > boutiques > luxurydesigner";


// BGA_1 LXR 6/11 - 7/2
bga_1_position = "15";
bga_1_type = "1";
bga_1_key = "bga_1_w19-19-b";
bga_1_line_1 = "<p class='jm-bga-line1'>ONLINE & IN SELECT STORES | 6/11-7/2</p>";
bga_1_h2 = "VINTAGE LOUIS VUITTON <br/><span>15% OFF<sup>*</sup></span>";
bga_1_aligment = "flex-start";
bga_1_url = "/categories/handbags-accessories-boutiques-lxr-vintage-luxury?imc=bga_p1&imccat=w1919b_lxrandco_handbags-accessories-boutiques-lxr-vintage-luxury";
bga_1_cta = "SHOP NOW";
bga_1_cta_type = "solidlight";
bga_1_text_top_cta = "<img alt='LXRandCO' src='refresh/refresh-2019/W1919/zBGA/LRXandCo-black.png?$staticlink$'>";
bga_1_img = "refresh/refresh-2019/W1919/zBGA/01_06Week2_BGA_LXR_Promo.jpg?$staticlink$";
bga_1_cat1 = "handbags&accessories";
bga_1_cat2 = "boutiques";
bga_1_cat3 = "luxurydesigner";



//BGAs LIST ATTRIBUTES


bga_cat_list_global = '{"gbgas":['+


  // BGA_1 CLEARANCE 6/23 - continuous
  '{  "gposition": "' + gbga_1_position +'",     '+ 
  '   "gtype": "' + gbga_1_type +'",     '+ 
  '   "gkey": "' + gbga_1_key +'",     '+ 
  '   "gcategories1": "' + gbga_1_cat1 +'",     '+ 
  '   "gcategories2": "todo",    '+
  '   "gcategories3": "todo",     '+
  '   "gcategories3_exception": "' + gbga_1_cat3_exceptions +'",     '+ 
  '   "gbga_aligment": "' + gbga_1_aligment +'",     '+ 
  '   "gbga_bg_image": "' + gbga_1_img +'",     '+ 
  '   "gbga_url": "' + gbga_1_url +'",     '+ 
  '   "gbga_line_1":"'  + gbga_1_line_1 + '",'+
  '   "gbga_h2":"'  + gbga_1_h2 + '",'+
  '   "gbga_text_top_cta":"'  + gbga_1_text_top_cta + '",'+
  '   "gbga_cta_type":"'  + gbga_1_cta_type + '",'+
  '   "gbga_cta_text":"'  + gbga_1_cta + '"'+            
  '}'+


']}';


bga_cat_list_specific = '{"bgas":['+

  // BGA_1 LXR 6/11 - 7/2
  '{  "position": "' + bga_1_position +'",     '+ 
  '   "type": "' + bga_1_type +'",     '+ 
  '   "key": "' + bga_1_key +'",     '+ 
  '   "categories1": "' + bga_1_cat1 +'",     '+ 
  '   "categories2": "' + bga_1_cat2 +'",     '+ 
  '   "categories3": "' + bga_1_cat3 +'",     '+ 
  '   "bga_aligment": "' + bga_1_aligment +'",     '+ 
  '   "bga_bg_image": "' + bga_1_img +'",     '+ 
  '   "bga_url": "' + bga_1_url +'",     '+ 
  '   "bga_line_1":"'  + bga_1_line_1 + '",'+
  '   "bga_h2":"'  + bga_1_h2 + '",'+
  '   "bga_text_top_cta":"'  + bga_1_text_top_cta + '",'+
  '   "bga_cta_type":"'  + bga_1_cta_type + '",'+
  '   "bga_cta_text":"'  + bga_1_cta + '"'+   
  '}'+


']}';

document.addEventListener("DOMContentLoaded", function(){

var is_there_breadcrumbs = $('.product-breadcrumb').length;



if((is_there_breadcrumbs != 0) && (window.location.href.indexOf("/categories/") > -1)){
  jm_fired_s = 0;
  jm_fired_g = 0;
  
  jm_breadcrumb_1 = $('.breadcrumb').children()[0];
  jm_breadcrumb_2 = $('.breadcrumb').children()[1];
  jm_breadcrumb_3 = $('.breadcrumb').children()[2];


    if((jm_breadcrumb_3 === undefined) || (jm_breadcrumb_3 == "todo")){
        jm_breadcrumb_1_text = jm_breadcrumb_1.innerText.replace(/ /g,'').toLowerCase();
        jm_breadcrumb_2_text = jm_breadcrumb_2.innerText.replace(/ /g,'').toLowerCase();
        jm_breadcrumb_3_text = "todo";        
    }
    else if((jm_breadcrumb_2 === undefined)){
        jm_breadcrumb_1_text = jm_breadcrumb_1.innerText.replace(/ /g,'').toLowerCase();
        jm_breadcrumb_2_text = "todo";
        jm_breadcrumb_3_text = "todo";
    }
    else{
        jm_breadcrumb_1_text = jm_breadcrumb_1.innerText.replace(/ /g,'').toLowerCase();
        jm_breadcrumb_2_text = jm_breadcrumb_2.innerText.replace(/ /g,'').toLowerCase();
        jm_breadcrumb_3_text = jm_breadcrumb_3.innerText.replace(/ /g,'').toLowerCase();        
    }
    jm_breadcrumb_all = jm_breadcrumb_1_text + " > " + jm_breadcrumb_2_text + " > " + jm_breadcrumb_3_text;
    scrolling_on_clp(jm_breadcrumb_1_text, jm_breadcrumb_2_text, jm_breadcrumb_3_text);
}

});

function scrolling_on_clp(jm_breadcrumb_1_text, jm_breadcrumb_2_text, jm_breadcrumb_3_text){
    console.log(jm_breadcrumb_1_text);
    console.log(jm_breadcrumb_2_text);
    console.log(jm_breadcrumb_3_text);
    console.log(jm_breadcrumb_all);
    window.onscroll = function() {
        if($('.product-breadcrumb')){
          on_scroll_show_bga_global(bga_cat_list_global);  
          on_scroll_show_bga_specific(bga_cat_list_specific);
        }
    };
}

function on_scroll_show_bga_specific(bga_cat_list_specific) {
    
    obj = JSON.parse(bga_cat_list_specific);

    var hT = $('.product-search-wrapper > div:nth-of-type('+ (obj.bgas[0].position - 3) +')').offset().top,
      hH = $('.product-search-wrapper > div:nth-of-type('+ (obj.bgas[0].position - 3) +')').outerHeight(),
      wH = $(window).height(),
      wS = $(this).scrollTop();

    if (wS > (hT+hH-wH)){
        for (var i = 0; i < obj.bgas.length; i++) {      
          var jm_is_category_1 = obj.bgas[i].categories1.split(',').indexOf(jm_breadcrumb_1_text) > -1;
          var jm_is_category_2 = obj.bgas[i].categories2.split(',').indexOf(jm_breadcrumb_2_text) > -1;
          var jm_is_category_3 = obj.bgas[i].categories3.split(',').indexOf(jm_breadcrumb_3_text) > -1;
          jm_fired_s++;


          if((jm_fired_s <= obj.bgas.length) && (jm_is_category_1) && (jm_is_category_2) && (jm_is_category_3)) {
            console.log("BGA specific");
            
            $('.product-search-wrapper > div:nth-of-type('+ (obj.bgas[i].position-1) +').tile-element').after(

              '<aside class="tile-box tile-element jm-bga-clp jm-bga-type-' + obj.bgas[i].type + '">'+
                '<div class="jm-bga-wrap jm-bga-14-' + obj.bgas[i].key + '" style="background: url(\' ' + obj.bgas[i].bga_bg_image + '\'); align-items: ' +  obj.bgas[i].bga_aligment + ';"> '+
                  '<div>'+
                    '<a class="jm-clickable-image" href="' + obj.bgas[i].bga_url + '" target="_blank" aria-hidden="true" role="none" tabindex="-1"></a>'+
                    obj.bgas[i].bga_line_1+
                    '<h2 class="jm-bga-header" id="jm-bga-header-' + obj.bgas[i].key + '">' + obj.bgas[i].bga_h2 + '</h2>'+
                    '<div class="jm-bga-cta-wrap">'+
                      obj.bgas[i].bga_text_top_cta +
                      '<a href="' + obj.bgas[i].bga_url + '" class="btn jm-cta-button jm-cta-button-' +  obj.bgas[i].bga_cta_type + '" id="jm-bga-cta-' + obj.bgas[i].key + '" aria-labelledby="jm-bga-cta-' + obj.bgas[i].key + ' jm-bga-header-' + obj.bgas[i].key + '">' + obj.bgas[i].bga_cta_text + '</a>'+
                    '</div>'+
                  '</div>'+
                '</div>'+
              '</aside>'

            )

          }

        }
    }

}


function on_scroll_show_bga_global(bga_cat_list_global) {
    //console.log("BGA function");
    obj = JSON.parse(bga_cat_list_global);

    var hT = $('.product-search-wrapper > div:nth-of-type('+ (obj.gbgas[0].gposition - 3) +')').offset().top,
      hH = $('.product-search-wrapper > div:nth-of-type('+ (obj.gbgas[0].gposition - 3) +')').outerHeight(),
      wH = $(window).height(),
      wS = $(this).scrollTop();

    if (wS > (hT+hH-wH)){
        for (var i = 0; i < obj.gbgas.length; i++) {      
          var jm_is_category_1 = obj.gbgas[i].gcategories1.split(',').indexOf(jm_breadcrumb_1_text) > -1;
          var jm_is_category_2 = obj.gbgas[i].gcategories2.split(',').indexOf(jm_breadcrumb_2_text) > -1;
          var jm_is_category_3 = obj.gbgas[i].gcategories3.split(',').indexOf(jm_breadcrumb_3_text) > -1;
          var jm_is_category_3_exception = obj.gbgas[i].gcategories3_exception.split(',').indexOf(jm_breadcrumb_all) > -1;
          jm_fired_g++;

          if((jm_fired_g <= obj.gbgas.length) && (jm_is_category_1) && (!jm_is_category_3_exception)) {
            
            $('.product-search-wrapper > div:nth-of-type('+ (obj.gbgas[i].gposition-1) +').tile-element').after(

              '<aside class="tile-box tile-element jm-bga-clp jm-bga-type-' + obj.gbgas[i].gtype + '">'+
                '<div class="jm-bga-wrap jm-bga-14-' + obj.gbgas[i].gkey + '" style="background: url(\' ' + obj.gbgas[i].gbga_bg_image + '\'); align-items: ' +  obj.gbgas[i].gbga_aligment + ';"> '+
                  '<div>'+
                    '<a class="jm-clickable-image" href="' + obj.gbgas[i].gbga_url + '" target="_blank" aria-hidden="true" role="none" tabindex="-1"></a>'+
                    obj.gbgas[i].gbga_line_1+
                    '<h2 class="jm-bga-header" id="jm-bga-header-' + obj.gbgas[i].gkey + '">' + obj.gbgas[i].gbga_h2 + '</h2>'+
                    '<div class="jm-bga-cta-wrap">'+
                      obj.gbgas[i].gbga_text_top_cta +
                      '<a href="' + obj.gbgas[i].gbga_url + '" class="btn jm-cta-button jm-cta-button-' +  obj.gbgas[i].gbga_cta_type + '" id="jm-bga-cta-' + obj.gbgas[i].gkey + '" aria-labelledby="jm-bga-cta-' + obj.gbgas[i].gkey + ' jm-bga-header-' + obj.gbgas[i].gkey + '">' + obj.gbgas[i].gbga_cta_text + '</a>'+
                    '</div>'+
                  '</div>'+
                '</div>'+
              '</aside>'

            )

          }

        }
    }

}
</script>